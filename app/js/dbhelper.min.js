'use strict';var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var DB_NAME='restaurantsDB',DB_TABLE_NAME='restaurants',DB_VERSION=1,PORT=1337,DBHelper=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:'fetchRestaurants',value:function fetchRestaurants(b){function d(f,g){b('Error occurred for '+g+' request. Returned status of '+f,null)}fetch(a.DATABASE_URL,{}).then(function(f){return f.json()}).then(function(f){var g=f,h=idb.open('restaurants',1,function(j){j.createObjectStore('restaurants',{keyPath:'id'})});h.then(function(j){var l=j.transaction('restaurants','readwrite'),k=l.objectStore('restaurants');return g.forEach(function(m){k.put(m)}),k.getAll()}),b(null,g)}).catch(function(f){return d(f,'restaurant')})}},{key:'fetchRestaurantById',value:function fetchRestaurantById(b,c){a.fetchRestaurants(function(d,f){if(d)c(d,null);else{var g=f.find(function(h){return h.id==b});g?c(null,g):c('Restaurant does not exist',null)}})}},{key:'fetchRestaurantByCuisine',value:function fetchRestaurantByCuisine(b,c){a.fetchRestaurants(function(d,f){if(d)c(d,null);else{var g=f.filter(function(h){return h.cuisine_type==b});c(null,g)}})}},{key:'fetchRestaurantByNeighborhood',value:function fetchRestaurantByNeighborhood(b,c){a.fetchRestaurants(function(d,f){if(d)c(d,null);else{var g=f.filter(function(h){return h.neighborhood==b});c(null,g)}})}},{key:'fetchRestaurantByCuisineAndNeighborhood',value:function fetchRestaurantByCuisineAndNeighborhood(b,c,d){a.fetchRestaurants(function(f,g){if(f)d(f,null);else{var h=g;'all'!=b&&(h=h.filter(function(j){return j.cuisine_type==b})),'all'!=c&&(h=h.filter(function(j){return j.neighborhood==c})),d(null,h)}})}},{key:'fetchNeighborhoods',value:function fetchNeighborhoods(b){a.fetchRestaurants(function(c,d){if(c)b(c,null);else{var f=d.map(function(h,j){return d[j].neighborhood}),g=f.filter(function(h,j){return f.indexOf(h)==j});b(null,g)}})}},{key:'fetchCuisines',value:function fetchCuisines(b){a.fetchRestaurants(function(c,d){if(c)b(c,null);else{var f=d.map(function(h,j){return d[j].cuisine_type}),g=f.filter(function(h,j){return f.indexOf(h)==j});b(null,g)}})}},{key:'urlForRestaurant',value:function urlForRestaurant(b){return'./restaurant.html?id='+b.id}},{key:'imageUrlForRestaurant',value:function imageUrlForRestaurant(b){return b.photograph?'/img/'+b.photograph+'.jpg':'/img/'+b.id+'.jpg'}},{key:'altUrlforRestaurant',value:function altUrlforRestaurant(b){return b.alt}},{key:'mapMarkerForRestaurant',value:function mapMarkerForRestaurant(b,c){var d=new google.maps.Marker({position:b.latlng,title:b.name,url:a.urlForRestaurant(b),map:c,animation:google.maps.Animation.DROP});return d}},{key:'DATABASE_URL',get:function get(){return'http://localhost:'+PORT+'/restaurants'}}]),a}();